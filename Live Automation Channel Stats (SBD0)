<form refresh="60">
  <label>Live Automation Channel Stats (SBD0)</label>
  <fieldset submitButton="false" autoRun="true"></fieldset>
  <row>
    <panel>
      <single>
        <title>Peak Concurrents</title>
        <search>
          <query>index="video-eng-live" sourcetype="channel-stats-test" | bin span=1m _time | dedup _time, message.title | chart span=1m sum(message.concurrent_sessions) as "Concurrent sessions" over _time by message.account | addtotals | sort -Total limit=1| fields Total</query>
          <earliest>$# concurrent sessions per account.earliest$</earliest>
          <latest>$# concurrent sessions per account.latest$</latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="colorBy">value</option>
        <option name="colorMode">none</option>
        <option name="drilldown">none</option>
        <option name="numberPrecision">0</option>
        <option name="rangeColors">["0x53a051", "0x0877a6", "0xf8be34", "0xf1813f", "0xdc4e41"]</option>
        <option name="rangeValues">[0,30,70,100]</option>
        <option name="refresh.display">progressbar</option>
        <option name="showSparkline">1</option>
        <option name="showTrendIndicator">1</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
        <option name="trendColorInterpretation">standard</option>
        <option name="trendDisplayMode">absolute</option>
        <option name="unitPosition">after</option>
        <option name="useColors">0</option>
        <option name="useThousandSeparators">1</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>UHD Total Peak (SDR + HDR)</title>
        <search>
          <query>index="video-eng-live" sourcetype="channel-stats-test" message.account="*fox_uhd*" | bin span=1m _time | dedup _time, message.title | chart span=1m sum(message.concurrent_sessions) as "Concurrent sessions" over _time by message.account | addtotals | sort -Total limit=1| fields Total</query>
          <earliest>$# concurrent sessions per account.earliest$</earliest>
          <latest>$# concurrent sessions per account.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>UHD HDR Peak</title>
        <search>
          <query>index="video-eng-live" sourcetype="channel-stats-test" message.account=fox_uhd_hdr | bin span=1m _time | dedup _time, message.title | chart span=1m sum(message.concurrent_sessions) as "Concurrent sessions" over _time by message.account | addtotals | sort -Total limit=1| fields Total</query>
          <earliest>$# concurrent sessions per account.earliest$</earliest>
          <latest>$# concurrent sessions per account.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
    <panel>
      <single>
        <title>UHD SDR Peak</title>
        <search>
          <query>index="video-eng-live" sourcetype="channel-stats-test" message.account=fox_uhd | bin span=1m _time | dedup _time, message.title | chart span=1m sum(message.concurrent_sessions) as "Concurrent sessions" over _time by message.account | addtotals | sort -Total limit=1| fields Total</query>
          <earliest>$# concurrent sessions per account.earliest$</earliest>
          <latest>$# concurrent sessions per account.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </single>
    </panel>
  </row>
  <row>
    <panel>
      <title>Number of Concurrent Sessions per Account</title>
      <input type="time" token="# concurrent sessions per account" searchWhenChanged="true">
        <label>Time Range</label>
        <default>
          <earliest>-60m@m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <chart>
        <title>Breakdown by Account Group</title>
        <search>
          <query>(index=* OR index=_*) (index="video-eng-live" sourcetype="channel-stats-test") | rename message.account as Account | bin span=1m _time | dedup _time, message.title | chart span=1m sum(message.concurrent_sessions) as "Concurrent sessions" over _time by Account | addtotals</query>
          <earliest>$# concurrent sessions per account.earliest$</earliest>
          <latest>$# concurrent sessions per account.latest$</latest>
          <sampleRatio>1</sampleRatio>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.text"># Concurrent Sessions</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="height">342</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Total Concurrent Sessions - all accounts</title>
      <table>
        <search>
          <query>(index=* OR index=_*) (index="video-eng-live" sourcetype="channel-stats-test") | dedup message.title | rename message.account as Account message.title as Channel message.concurrent_sessions as "Concurrent Sessions" | table  Account, Channel, "Concurrent Sessions" | addcoltotals | fillnull Account value="Total" | sort -"Concurrent Sessions"</query>
          <earliest>-1m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="count">50</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Number of Concurrent Sessions for $account_tok$ per Channel</title>
      <input type="dropdown" token="account_tok" searchWhenChanged="true">
        <label>Account Group</label>
        <default>fox_sports</default>
        <choice value="fox_national">Fox National</choice>
        <choice value="fox_owned_affiliates">Fox Owned Affiliates</choice>
        <choice value="fox_sports">Fox Sports</choice>
        <choice value="fox_news">Fox News</choice>
        <choice value="fox_nation">Fox Nation</choice>
        <choice value="fox_uhd">Fox UHD</choice>
        <choice value="fox_uhd_hdr">Fox UHD HDR</choice>
      </input>
      <input type="time" token="# concurrent sessions per channel" searchWhenChanged="true">
        <label>Time Range</label>
        <default>
          <earliest>-60m@m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <chart>
        <search>
          <query>(index=* OR index=_*) (index="video-eng-live" sourcetype="channel-stats-test") message.account=$account_tok$ | rename message.title as Channel | timechart span=1m limit=0 max(message.concurrent_sessions) by Channel</query>
          <earliest>$# concurrent sessions per channel.earliest$</earliest>
          <latest>$# concurrent sessions per channel.latest$</latest>
          <sampleRatio>1</sampleRatio>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.text"># Concurrent Sessions</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="height">338</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
    <panel>
      <title>Number of Concurrent Sessions for $account_tok$ per Channel (real time, collected every minute)</title>
      <table>
        <search>
          <query>index="video-eng-live"  sourcetype="channel-stats-test" message.account=$account_tok$ | dedup message.title | sort -num(message.concurrent_sessions) | rename message.concurrent_sessions as "Concurrent sessions" message.title as "Channel" | fieldformat Channel=tostring(Channel) | table Channel, "Concurrent sessions" | append [search index="video-eng-live"  sourcetype="channel-stats-test" message.account=$account_tok$ | convert num(message.concurrent_sessions) as "Concurrent Sessions" | stats sum("Concurrent Sessions") as "Concurrent sessions" | fillnull value="Total" Channel ]</query>
          <earliest>-1m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="count">50</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Missing Content Slate per Account</title>
      <input type="time" token="missing slate per account" searchWhenChanged="true">
        <label>Time Range</label>
        <default>
          <earliest>-60m@m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <chart>
        <search>
          <query>index=video-eng-live sourcetype="channel-stats-test" message.missing_content_slate&gt;0 | dedup message.title message.timestamp | rename message.account as Account | bin span=1m _time | dedup _time, message.title | chart span=1m sum(message.missing_content_slate) as "Missing Content Slate" over _time by Account</query>
          <earliest>$missing slate per account.earliest$</earliest>
          <latest>$missing slate per account.latest$</latest>
          <sampleRatio>1</sampleRatio>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.text">Sum of message.missing_content_slate</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="height">269</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Percent of Users with Missing Content Slate for $account_missing$ per Channel</title>
      <input type="time" token="missing slate per channel" searchWhenChanged="true">
        <label>Time Range</label>
        <default>
          <earliest>-60m@m</earliest>
          <latest>now</latest>
        </default>
      </input>
      <input type="dropdown" token="account_missing">
        <label>Account Group</label>
        <fieldForLabel>message.account</fieldForLabel>
        <fieldForValue>message.account</fieldForValue>
        <search>
          <query>index=video-eng-live sourcetype="channel-stats-test" message.missing_content_slate&gt;0 | dedup message.account</query>
          <earliest>$missing slate per channel.earliest$</earliest>
          <latest>$missing slate per channel.latest$</latest>
        </search>
        <default>fox_sports</default>
        <initialValue>fox_nation</initialValue>
      </input>
      <chart>
        <search>
          <query>index=video-eng-live sourcetype="channel-stats-test" message.missing_content_slate&gt;0 message.account=$account_missing$ | rename message.title as Channel | bin span=1m _time | dedup _time, Channel | eval ratio=if(('message.missing_content_slate'/'message.concurrent_sessions') &lt;= 1, round(('message.missing_content_slate'/'message.concurrent_sessions') * 100, 2), 100) | chart sum(ratio) as "Percent sessions w/ missing slate" over _time by Channel</query>
          <earliest>$missing slate per channel.earliest$</earliest>
          <latest>$missing slate per channel.latest$</latest>
          <sampleRatio>1</sampleRatio>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.text">Time</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.text">% Users Missing Contet</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">line</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">none</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">all</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="height">282</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>Top 10 Channels and Total Concurrent Sessions for All Channels (real time, collected every minute)</title>
      <chart>
        <search>
          <query>index="video-eng-live"  sourcetype="channel-stats-test" | convert num(message.concurrent_sessions) as "Concurrent Sessions" | stats sum("Concurrent Sessions") as "Concurrent sessions" | fillnull value="Total Concurrent Sessions" Channel | append [ search index="video-eng-live"  sourcetype="channel-stats-test" | sort 10 -num(message.concurrent_sessions) | rename message.concurrent_sessions as "Concurrent sessions" message.title as "Channel" ] | fieldformat Channel=tostring(Channel) | table Channel, "Concurrent sessions"</query>
          <earliest>-1m</earliest>
          <latest>now</latest>
          <sampleRatio>1</sampleRatio>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.axisLabelsX.majorLabelStyle.overflowMode">ellipsisNone</option>
        <option name="charting.axisLabelsX.majorLabelStyle.rotation">0</option>
        <option name="charting.axisTitleX.visibility">visible</option>
        <option name="charting.axisTitleY.visibility">visible</option>
        <option name="charting.axisTitleY2.visibility">visible</option>
        <option name="charting.axisX.scale">linear</option>
        <option name="charting.axisY.scale">linear</option>
        <option name="charting.axisY2.enabled">0</option>
        <option name="charting.axisY2.scale">inherit</option>
        <option name="charting.chart">bar</option>
        <option name="charting.chart.bubbleMaximumSize">50</option>
        <option name="charting.chart.bubbleMinimumSize">10</option>
        <option name="charting.chart.bubbleSizeBy">area</option>
        <option name="charting.chart.nullValueMode">gaps</option>
        <option name="charting.chart.showDataLabels">all</option>
        <option name="charting.chart.sliceCollapsingThreshold">0.01</option>
        <option name="charting.chart.stackMode">default</option>
        <option name="charting.chart.style">shiny</option>
        <option name="charting.drilldown">none</option>
        <option name="charting.layout.splitSeries">0</option>
        <option name="charting.layout.splitSeries.allowIndependentYRanges">0</option>
        <option name="charting.legend.labelStyle.overflowMode">ellipsisMiddle</option>
        <option name="charting.legend.placement">right</option>
        <option name="trellis.enabled">0</option>
        <option name="trellis.scales.shared">1</option>
        <option name="trellis.size">medium</option>
      </chart>
    </panel>
  </row>
</form>
